<!DOCTYPE html><html lang="zh-cn"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> JavaScript Event · Haner.Du</title><meta name="description" content="JavaScript Event - Haner"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">博客</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">归档</a></li><li class="nav-list-item"><a href="https://github.com/haner199401" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">JavaScript Event</h1><div class="post-info">2016年7月8日</div><div class="post-content"><p><img src="https://raw.githubusercontent.com/haner199401/haner.blog/master/images/javascript-event.jpg" alt></p>
<a id="more"></a>
<h3 id="Javascript-事件冒泡和捕获的学习"><a href="#Javascript-事件冒泡和捕获的学习" class="headerlink" title="Javascript 事件冒泡和捕获的学习"></a>Javascript 事件冒泡和捕获的学习</h3><hr>
<pre><code>&lt;body&gt;
    &lt;ul class=&quot;ulclass&quot;&gt;
        &lt;li class=&quot;li1class&quot;&gt;1&lt;/li&gt;
    &lt;/ul&gt;
&lt;/body&gt;
</code></pre><h3 id="实验一："><a href="#实验一：" class="headerlink" title="实验一："></a>实验一：</h3><pre><code>&lt;script type=&quot;text/javascript&quot;&gt;
    var $El = document.querySelector(&quot;.ulclass&quot;);
    var $El1 = document.querySelector(&quot;.li1class&quot;);

    //冒泡
    $El.addEventListener(&quot;click&quot;,function(){
        alert(&quot;ul&quot;);
    },false);
    //捕获 
    $El1.addEventListener(&quot;click&quot;,function(){
        alert(&quot;li&quot;);
    },true);
&lt;/script&gt;
</code></pre><p>实验分析：冒泡执行过程中是从最内层元素 li 开始往外冒泡，在 经过 li 一层元素后到达 ul 被触发。而捕获过程则一共经历 window-&gt; document -&gt; body -&gt; ul 四层元素后到达 li ，被触发，看起来好像是应该先弹出 ul ，然后再弹出 li。</p>
<p>实验结果：点击 li 内的 1 的时候，第一次弹出 “li”，第二次弹出 “ul” 。</p>
<h4 id="猜想一"><a href="#猜想一" class="headerlink" title="猜想一"></a>猜想一</h4><ul>
<li><strong>在冒泡事件和捕获事件同时存在的情况下，捕获事件优先级高一点</strong>。</li>
</ul>
<p>为了验证这个猜想，再来做几个实验：</p>
<h3 id="实验二"><a href="#实验二" class="headerlink" title="实验二"></a>实验二</h3><pre><code>&lt;script type=&quot;text/javascript&quot;&gt;
    var $El = document.querySelector(&quot;.ulclass&quot;);
    var $El1 = document.querySelector(&quot;.li1class&quot;);
    //捕获
    $El.addEventListener(&quot;click&quot;,function(){
        alert(&quot;ul&quot;);
    },true);

    //冒泡
    $El1.addEventListener(&quot;click&quot;,function(){
        alert(&quot;li&quot;);
    },false);
&lt;/script&gt;
</code></pre><p>实验分析：如果上述猜想是正确的，那么这次的执行结果就应该是先弹出 “ul” 再弹出 “li”。</p>
<p>实验结果：先弹出 “ul” 再弹出 “li”。</p>
<h3 id="实验四"><a href="#实验四" class="headerlink" title="实验四"></a>实验四</h3><p>再来试一下两个事件都冒泡的情况：</p>
<pre><code>//冒泡
$El.addEventListener(&quot;click&quot;,function(){
    alert(&quot;ul&quot;);
},false);

//冒泡
$El1.addEventListener(&quot;click&quot;,function(){
    alert(&quot;li&quot;);
},false);
</code></pre><p>实验分析：如果两个都为冒泡的情况下，点击后应从最里面的元素往外冒，也就是先弹出 li , 再弹出 ul.</p>
<p>实验结果：无误。</p>
<p>然后将两个事件都改成捕获，则先弹出 ul 再 弹出 li ，与预期完全一样。</p>
<h3 id="实验五"><a href="#实验五" class="headerlink" title="实验五"></a>实验五</h3><p>这里把本来在 ul 上绑定的事件放到 li 上，也就是 li 绑定两个事件，一个为冒泡，一个为捕获。</p>
<pre><code>var $El = document.querySelector(&quot;.ulclass&quot;);
var $El1 = document.querySelector(&quot;.li1class&quot;);
//冒泡
$El1.addEventListener(&quot;click&quot;,function(){
    alert(&quot;冒泡&quot;);
},false);

//捕获
$El1.addEventListener(&quot;click&quot;,function(){
    alert(&quot;捕获&quot;);
},true);
</code></pre><p>实验分析：按照之前的猜测，应该是先弹出捕获，然后弹出冒泡。（如果是这样的话我也不会写这么多了…）<br>实验结果：先弹出了 冒泡，然后弹出了捕获。</p>
<p>为什么？？</p>
<h4 id="猜想二"><a href="#猜想二" class="headerlink" title="猜想二"></a>猜想二</h4><ul>
<li><strong>在同一个元素的绑定事件中，冒泡和捕获没有次序之分，遵循Javascript的执行顺序。</strong></li>
</ul>
<h4 id="实验六"><a href="#实验六" class="headerlink" title="实验六"></a>实验六</h4><p>为了进一步证实这个猜测…我们将冒泡和捕获的位置调换一下</p>
<pre><code>var $El = document.querySelector(&quot;.ulclass&quot;);
var $El1 = document.querySelector(&quot;.li1class&quot;);
//捕获
$El1.addEventListener(&quot;click&quot;,function(){
    alert(&quot;捕获&quot;);
},true);

//冒泡
$El1.addEventListener(&quot;click&quot;,function(){
    alert(&quot;冒泡&quot;);
},false);
</code></pre><p>实验结果： 先捕获，后冒泡。</p>
<p>看似是这样了，但是在重复实验五 的时候，li下一级有一个元素 a ，直接点击 li 很符合上面的推测，但是在点击a元素的时候，先弹出了捕获。</p>
<p>为什么？？</p>
<h4 id="猜测三"><a href="#猜测三" class="headerlink" title="猜测三"></a>猜测三</h4><ul>
<li><strong>在元素上同时绑定捕获事件和冒泡事件，如果通过此元素的子级元素触发，则优先触发捕获事件，若不通过此元素的子级元素触发，则按照Javascript执行顺序触发。</strong></li>
</ul>
<p>附：</p>
<p>冒泡经常用于需要绑定很多事件的时候，给他们父级元素绑定一个事件，可以有效的提高代码执行效率。<br>比如：</p>
<pre><code>&lt;body&gt;
&lt;div class=&quot;&quot;&gt;
    &lt;ul class=&quot;ulclass&quot;&gt;
        &lt;li class=&quot;li1class&quot;&gt;1&lt;/li&gt;
        &lt;li class=&quot;li1class&quot;&gt;1&lt;/li&gt;
        &lt;li class=&quot;li1class&quot;&gt;1&lt;/li&gt;
        ...
        ...
        &lt;li class=&quot;li1class&quot;&gt;1&lt;/li&gt;
    &lt;/ul&gt;
&lt;/div&gt;
&lt;/body&gt;
</code></pre><p>假如此处有100个li，每个li元素上都绑定一个事件的话就验证影响了执行效率，那么就可以在ul 上绑定一个事件：</p>
<pre><code>&lt;script type=&quot;text/javascript&quot;&gt;
    var $El = document.querySelector(&quot;.ulclass&quot;);
    //冒泡
    $El.addEventListener(&quot;click&quot;,function(){
        console.log(event.target);
    },false);
&lt;/script&gt;
</code></pre><p>其中 event.target 就是获取触发来源。<br>it’ OK。</p>
<p>欢迎指正。</p>
</div></article></div></section><footer><div class="paginator"></div><!--include partial/comment--><div class="copyright"><p>简单点,装逼的方式简单点~</p><p><a href="https://haner199401.github.io">Haner</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>